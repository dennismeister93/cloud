'use client';

import { Badge } from '@/components/ui/badge';
import { ShieldAlert, ShieldCheck } from 'lucide-react';
import type { SecurityFindingAnalysis } from '@/lib/security-agent/core/types';

type ExploitabilityBadgeProps = {
  analysis: SecurityFindingAnalysis | null | undefined;
  size?: 'sm' | 'default';
};

/**
 * Displays exploitability status from sandbox analysis.
 * Only shows badge when isExploitable is true or false (not 'unknown').
 */
export function ExploitabilityBadge({ analysis, size = 'default' }: ExploitabilityBadgeProps) {
  const isExploitable = analysis?.sandboxAnalysis?.isExploitable;

  // Don't show badge if no analysis, no sandbox analysis, or unknown
  if (isExploitable === undefined || isExploitable === 'unknown') {
    return null;
  }

  const iconClass = size === 'sm' ? 'h-3 w-3' : 'h-4 w-4';

  if (isExploitable === true) {
    return (
      <Badge variant="outline" className="border-red-500/30 bg-red-500/20 text-red-400">
        <ShieldAlert className={`mr-1 ${iconClass}`} />
        Exploitable
      </Badge>
    );
  }

  return (
    <Badge variant="outline" className="border-green-500/30 bg-green-500/20 text-green-400">
      <ShieldCheck className={`mr-1 ${iconClass}`} />
      Not Exploitable
    </Badge>
  );
}
